from automata.fa.Moore import Moore
from sys import argv

moore = Moore(['q0', 'q1', 'q2', 'q3', 'q4'],
              ['i' , 'n' , 't', ' ',],
              ['INT', 'ELSE', 'WHILE', 'RETURN', 'VOID', 'IF'],
              {
                  'q0' : {
                      ' ': 'q0',
                      '\n': 'q0',

                      '0': 'q72',
                      '1': 'q72',
                      '2': 'q72',
                      '3': 'q72',
                      '4': 'q72',
                      '5': 'q72',
                      '6': 'q72',
                      '7': 'q72',
                      '8': 'q72',
                      '9': 'q72',
                      
                      ';': 'q51',
                      '=': 'q50',
                      '{': 'q49',
                      '}': 'q48',
                      
                      'e': 'q24',
                      'i': 'q1',
                      'r': 'q16',
                      'v': 'q21',
                      'w': 'q5',
                      
                      '/': 'q33',
                      '+': 'q11',
                      '<': 'q22',
                      '>': 'q36',
                      '-': 'q34',
                      '*': 'q35',
                      '!': 'q29',
                      '(': 'q44',
                      ')': 'q45',
                      '[': 'q46',
                      ']': 'q47',
                      ',': 'q52',
                      
                      'a': 'q71',
                      'b': 'q71',
                      'c': 'q71',
                      'd': 'q71',
                      'f': 'q71',
                      'g': 'q71',
                      'h': 'q71',
                      'j': 'q71',
                      'k': 'q71',
                      'l': 'q71',
                      'm': 'q71',
                      'n': 'q71',
                      'o': 'q71',
                      'p': 'q71',
                      'q': 'q71',
                      's': 'q71',
                      't': 'q71',
                      'u': 'q71',
                      'x': 'q71',
                      'y': 'q71',
                      'z': 'q71',
                  },
                  
                  'q72': {
                      '0': 'q72',
                      '1': 'q72',
                      '2': 'q72',
                      '3': 'q72',
                      '4': 'q72',
                      '5': 'q72',
                      '6': 'q72',
                      '7': 'q72',
                      '8': 'q72',
                      '9': 'q72',
                      
                      ' ' : 'q75',
                      '\n': 'q75',
                  },
                  'q75': {
                      ' ' : 'q0',
                      '\n': 'q0',
                  },
                  'q51': {
                      ' ' : 'q0',
                      '\n': 'q0',
                  },
                  'q50': {
                      ' ' : 'q0',
                      '\n': 'q0',
                  },
                  'q49': {
                      ' ' : 'q0',
                      '\n': 'q0',
                  },
                  'q48': {
                      ' ' : 'q0',
                      '\n': 'q0',
                  },
                  
                  'q24': {
                      'l' : 'q0',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q25': {
                      's' : 'q0',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q26': {
                      'e' : 'q0',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q27': {
                      ' ' : 'q0',
                      '\n': 'q0',
                  },
                  
                  
                  'q1': {
                      'n': 'q2',
                      'f': 'q23',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q23': {
                      ' ': 'q0',
                      '\n': 'q0',
                      
                  },
                  'q2': {
                      't': 'q4',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',

                  },
                  'q4': {
                      '\n': 'q0',
                      ' ' : 'q0',
                  },
                  
                  'q16': {
                      'e' : 'q17',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q17': {
                      't' : 'q18',

                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q18': {
                      'u' : 'q19',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q19': {
                      'r' : 'q20',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q20': {
                      'n' : 'q28',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q28': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q21': {
                      'o' : 'q30',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q30': {
                      'i' : 'q31',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q31': {
                      'd' : 'q32',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q32': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q5': {
                      'h' : 'q6',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q6': {
                      'i' : 'q7',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q7': {
                      'l' : 'q8',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q8': {
                      'e'  : 'q10',
                      ' ' : 'q73',
                      '\n': 'q73',
                      'a' : 'q71',
                      'b' : 'q71',
                      'c' : 'q71',
                      'd' : 'q71',
                      'e' : 'q71',
                      'g' : 'q71',
                      'h' : 'q71',
                      'i' : 'q71',
                      'j' : 'q71',
                      'k' : 'q71',
                      'l' : 'q71',
                      'm' : 'q71',
                      'o' : 'q71',
                      'p' : 'q71',
                      'q' : 'q71',
                      'r' : 'q71',
                      's' : 'q71',
                      't' : 'q71',
                      'u' : 'q71',
                      'v' : 'q71',
                      'x' : 'q71',
                      'w' : 'q71',
                      'y' : 'q71',
                      'z' : 'q71',
                  },
                  'q10': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q33': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q11': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q22': {
                      '='  : 'q15',
                      ' '  : 'q12',
                      '\n' : 'q12',
                  },
                  
                  'q15': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q12': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q36': {
                      '='  : 'q38',
                      
                      ' '  : 'q37',
                      '\n' : 'q37',
                  },
                  
                  'q38': {
                      '='  : 'q41',
                      
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q37': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q34': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q35': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q29': {
                      '='  : 'q42',
                  },
                  
                  'q42': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q44': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q45': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q46': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q47': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q52': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
                  'q71':{
                      'a': 'q71',
                      'b': 'q71',
                      'c': 'q71',
                      'd': 'q71',
                      'e': 'q71',
                      'f': 'q71',
                      'g': 'q71',
                      'h': 'q71',
                      'i': 'q71',
                      'j': 'q71',
                      'k': 'q71',
                      'l': 'q71',
                      'm': 'q71',
                      'n': 'q71',
                      'o': 'q71',
                      'p': 'q71',
                      'q': 'q71',
                      'r': 'q71',
                      's': 'q71',
                      't': 'q71',
                      'u': 'q71',
                      'v': 'q71',
                      'w': 'q71',
                      'x': 'q71',
                      'y': 'q71',
                      'z': 'q71',
                      
                      ' ': 'q73',
                      '\n': 'q73', 
                  },
                  
                  'q73': {
                      ' '  : 'q0',
                      '\n' : 'q0',
                  },
                  
              },

              'q0',
              {
                  'q0' : '',
                  'q1' : '',
                  'q2' : '',
                  'q3' : '',
                  'q4' : 'INT\n',
                  'q5' : '',
                  'q6' : '',
                  'q7' : '',
                  'q8' : '',
                  'q9' : '',
                  'q10': 'WHILE\n',
                  
                  'q11' : 'PLUS\n',
                  'q12' : 'LESS\n',
                  'q13' : '',
                  'q14' : '',
                  'q15' : 'LESS_EQUAL\n',
                  'q16' : '',
                  'q17' : '',
                  'q18' : '',
                  'q19' : '',
                  'q20' : '',
                  
                  'q21' : '',
                  'q22' : '',
                  'q23' : 'IF\n',
                  'q24' : '',
                  'q25' : '',
                  'q26' : '',
                  'q27' : 'ELSE\n',
                  'q28' : 'RETURN\n',
                  'q29' : '',
                  'q30' : '',
                  
                  'q31' : '',
                  'q32' : 'VOID\n',
                  'q33' : 'DIVIDE\n',
                  'q34' : 'MINUS\n',
                  'q35' : 'TIMES\n',
                  'q36' : '',
                  'q37' : 'GREATER\n',
                  'q38' : 'GREATER_EQUAL\n',
                  'q39' : '',
                  'q40' : '',
                  
                  'q41' : 'EQUALS\n',
                  'q42' : 'DIFFERENT\n',
                  'q43' : '',
                  'q44' : 'LPAREN\n',
                  'q45' : 'RPAREN\n',
                  'q46' : 'LBRACKETS\n',
                  'q47' : 'RBRACKETS\n',
                  'q48' : 'RBRACES\n',
                  'q49' : 'LBRACES\n',
                  'q50' : 'ATTRIBUTION\n',
                  
                  'q51' : 'SEMICOLON\n',
                  'q52' : 'COMMA\n',
                  'q53' : '',
                  'q54' : '',
                  'q55' : '',
                  'q56' : '',
                  'q57' : '',
                  'q58' : '',
                  'q59' : '',
                  'q60' : '',
                  
                  'q61' : '',
                  'q62' : '',
                  'q63' : '',
                  'q64' : '',
                  'q65' : '',
                  'q66' : '',
                  'q67' : '',
                  'q68' : '',
                  'q69' : '',
                  'q70' : '',
                  
                  'q71' : '',
                  'q72' : '',
                  'q73' : 'ID\n',
                  'q74' : '',
                  'q75' : 'NUMBER\n',
                  'q76' : '',
              }
              )

if __name__ == "__main__":
    if len(argv) < 2 :
        raise IOError("Use "+ argv[0] + " file.cm")
    else :
        aux = argv[1].split('.')
        if aux[-1] != 'cm':
            raise IOError("Not a .cm file!")
        data = open(argv[1])

        source_file = data.read()

        print("Definição da Máquina")
        print(moore)

        print("Entrada:")
        print(source_file)

        print("Lista de Tokens:")
        print(moore.get_output_from_string(source_file))

